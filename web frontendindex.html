<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CITRA | Control Panel</title>

<style>
*{margin:0;padding:0;box-sizing:border-box}

/* ===== VARIABLES ===== */
:root{
    --primary:#8b5cf6;
    --danger:#b91c1c;
    --success:#22c55e;
    --light:#ecfdf5;
    --border:#166534;
    --bg-panel:rgba(2,44,34,.95);
}

/* ===== BASE ===== */
body{
    font-family:Inter,system-ui,sans-serif;
    background:radial-gradient(circle at top,#052e16,#020617);
    color:var(--light);
    min-height:100vh;
    padding:20px;
    transition:.4s;
}
body.power-off{background:#000;color:#333}

.container{
    max-width:1200px;
    margin:auto;
    display:flex;
    flex-direction:column;
    gap:24px;
}

/* ===== HEADER ===== */
header{
    display:flex;
    justify-content:space-between;
    align-items:center;
    padding:20px 24px;
    background:var(--bg-panel);
    border-radius:16px;
    border:1px solid var(--border);
}

h1{font-size:1.8rem}
.v-tag{
    background:var(--primary);
    padding:2px 8px;
    border-radius:6px;
    font-size:.75rem;
}

.badge{
    padding:8px 16px;
    border-radius:20px;
    font-weight:600;
    background:var(--danger);
}
.badge.connected{background:var(--success)}

/* ===== PANELS ===== */
.dashboard{
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(280px,1fr));
    gap:24px;
}
.panel{
    background:var(--bg-panel);
    border-radius:16px;
    border:1px solid var(--border);
    padding:24px;
}

/* ===== TELEMETRY ===== */
#status-data{
    font-family:Consolas,monospace;
    background:rgba(0,0,0,.45);
    padding:16px;
    border-radius:12px;
    color:#86efac;
    white-space:pre-wrap;
}

/* ===== CONTROLS ===== */
.joystick-grid{
    display:grid;
    grid-template-rows:auto 1fr auto;
    gap:12px;
    max-width:240px;
    margin:auto;
}
.middle-row{
    display:flex;
    justify-content:center;
    gap:12px;
}

.btn{
    padding:14px;
    border-radius:12px;
    font-weight:600;
    cursor:pointer;
    transition:.15s;
}

/* MOVIMIENTO (BORDE) */
.btn-action{
    background:transparent;
    border:2px solid var(--primary);
    color:var(--primary);
}
.btn-action:hover{
    background:rgba(139,92,246,.15);
    transform:scale(1.05);
}

/* STOP */
.btn-stop{
    background:transparent;
    border:2px solid var(--danger);
    color:var(--danger);
}
.btn-stop:hover{
    background:rgba(185,28,28,.15);
    transform:scale(1.05);
}

/* ===== DATA STREAM ===== */
.algorithms-panel{
    background:var(--bg-panel);
    border-radius:16px;
    border:1px solid var(--border);
    padding:24px;
}
.number-stream{
    margin-top:16px;
    font-family:Consolas,monospace;
    color:#22ff88;
    background:#000;
    padding:16px;
    border-radius:12px;
    height:180px;
    overflow:hidden;
    border:1px solid #14532d;
}

/* ===== POWER PANEL ===== */
.power-panel{
    text-align:center;
}
.power-btn-large{
    margin-top:12px;
    padding:16px 28px;
    font-size:1rem;
    font-weight:700;
    border-radius:14px;
    background:transparent;
    border:2px solid var(--danger);
    color:var(--danger);
    cursor:pointer;
    transition:.2s;
}
.power-btn-large:hover{
    background:rgba(185,28,28,.15);
    transform:scale(1.05);
}
.power-btn-large.on{
    border-color:var(--success);
    color:var(--success);
}
.power-btn-large.on:hover{
    background:rgba(34,197,94,.15);
}

/* ===== SHUTDOWN ===== */
.shutting-down::before{
    content:"";
    position:fixed;
    inset:0;
    background:linear-gradient(180deg,rgba(0,20,0,.95),#000);
    z-index:1000;
    animation:shutdown 3s forwards;
}
@keyframes shutdown{
    from{clip-path:inset(0)}
    to{clip-path:inset(0 100%)}
}

/* ===== MATRIX TEXT ===== */
.matrix-text{
    position:fixed;
    inset:0;
    font-family:monospace;
    color:#00ff41;
    pointer-events:none;
    z-index:999;
}
.matrix-char{
    position:absolute;
    animation:fall 2s linear infinite;
}
@keyframes fall{
    from{transform:translateY(-100px);opacity:1}
    to{transform:translateY(100vh);opacity:0}
}
</style>
</head>

<body class="power-off">

<div class="matrix-text" id="matrixText"></div>

<div class="container">

<header>
    <h1>CITRA <span class="v-tag">v1.0</span></h1>
    <div id="status-indicator" class="badge">Desconectado</div>
</header>

<section class="panel power-panel">
    <h3>Control de Energía</h3>
    <button class="power-btn-large" id="powerButton">⏻ ENCENDER SISTEMA</button>
</section>

<main class="dashboard">

<section class="panel">
    <h3>Telemetría</h3>
    <div id="status-data">Sistema apagado</div>
</section>

<section class="panel">
    <h3>Control de Movimiento</h3>
    <div class="joystick-grid">
        <button class="btn btn-action" onclick="move('Adelante')">↑</button>
        <div class="middle-row">
            <button class="btn btn-action" onclick="move('Izquierda')">←</button>
            <button class="btn btn-stop" onclick="stopRobot()">STOP</button>
            <button class="btn btn-action" onclick="move('Derecha')">→</button>
        </div>
        <button class="btn btn-action" onclick="move('Atrás')">↓</button>
    </div>
</section>

</main>

<section class="algorithms-panel">
    <h3>Guardado de Archivo</h3>
    <pre id="number-stream" class="number-stream">Sistema apagado</pre>
</section>

</div>

<script>
let connected=false;
let shuttingDown=false;

const statusIndicator=document.getElementById("status-indicator");
const statusData=document.getElementById("status-data");
const numberStream=document.getElementById("number-stream");
const powerButton=document.getElementById("powerButton");
const matrixText=document.getElementById("matrixText");

function setPowerState(on){
    connected=on;
    document.body.classList.toggle("power-off",!on);
    statusIndicator.textContent=on?"Conectado":"Desconectado";
    statusIndicator.classList.toggle("connected",on);
    statusData.textContent=on?"Sistema operativo":"Sistema apagado";
    
    // Update button text and appearance
    if(on){
        powerButton.textContent="⏻ APAGAR SISTEMA";
        powerButton.classList.add("on");
    }else{
        powerButton.textContent="⏻ ENCENDER SISTEMA";
        powerButton.classList.remove("on");
    }
}

function updateTelemetry(dir="Detenido",speed=0){
    statusData.textContent=
`Estado del Sistema
Batería: 87%
Velocidad: ${speed}
Dirección: ${dir}
Hora: ${new Date().toLocaleTimeString()}`;
}

function move(dir){
    if(!connected||shuttingDown)return;
    updateTelemetry(dir,50);
}
function stopRobot(){
    if(!connected||shuttingDown)return;
    updateTelemetry();
}

setInterval(()=>{
    if(!connected||shuttingDown){
        numberStream.textContent="Sistema apagado";
        return;
    }
    numberStream.textContent=
        Array.from({length:10},()=>
            Array.from({length:14},()=>Math.floor(Math.random()*10)).join(" ")
        ).join("\n");
},120);

powerButton.onclick=()=>{
    if(shuttingDown){
        // If currently shutting down, don't allow interaction
        return;
    }
    
    if(connected){
        // Shut down process
        shuttingDown=true;
        setPowerState(false);
        document.body.classList.add("shutting-down");
        createMatrixText();
        setTimeout(()=>shuttingDown=false,3000);
    }else{
        // Power on immediately
        setPowerState(true);
    }
};

function createMatrixText(){
    matrixText.innerHTML="";
    const cols=Math.floor(innerWidth/20);
    for(let i=0;i<cols;i++){
        const c=document.createElement("div");
        c.className="matrix-char";
        c.style.left=`${i*20}px`;
        c.style.animationDelay=`${Math.random()*2}s`;
        c.textContent=Math.random()>.5?"1":"0";
        matrixText.appendChild(c);
    }
}

// Auto-connect demo on initial load
setTimeout(()=>setPowerState(true),2000);
</script>

</body>
</html>

